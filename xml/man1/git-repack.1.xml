<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<?asciidoc-toc?>
<?asciidoc-numbered?>
<refentry>
<refmeta>
<refentrytitle>git-repack</refentrytitle>
<manvolnum>1</manvolnum>
<refmiscinfo class="source">Git</refmiscinfo>
<refmiscinfo class="manual">Git Manual</refmiscinfo>
</refmeta>
<refnamediv>
  <refname>git-repack</refname>
  <refpurpose>Pack unpacked objects in a repository</refpurpose>
</refnamediv>
<refsynopsisdiv id="_synopsis">
<blockquote>
<literallayout><emphasis>git repack</emphasis> [-a] [-A] [-d] [-f] [-F] [-l] [-n] [-q] [-b] [--window=&lt;n&gt;] [--depth=&lt;n&gt;]</literallayout>
</blockquote>
</refsynopsisdiv>
<refsect1 id="_description">
<title>DESCRIPTION</title>
<simpara>This command is used to combine all objects that do not currently
reside in a "pack", into a pack.  It can also be used to re-organize
existing packs into a single, more efficient pack.</simpara>
<simpara>A pack is a collection of objects, individually compressed, with
delta compression applied, stored in a single file, with an
associated index file.</simpara>
<simpara>Packs are used to reduce the load on mirror systems, backup
engines, disk storage, etc.</simpara>
</refsect1>
<refsect1 id="_options">
<title>OPTIONS</title>
<variablelist>
<varlistentry>
<term>
-a
</term>
<listitem>
<simpara>
        Instead of incrementally packing the unpacked objects,
        pack everything referenced into a single pack.
        Especially useful when packing a repository that is used
        for private development. Use
        with <emphasis>-d</emphasis>.  This will clean up the objects that <literal>git prune</literal>
        leaves behind, but <literal>git fsck --full --dangling</literal> shows as
        dangling.
</simpara>
<simpara>Note that users fetching over dumb protocols will have to fetch the
whole new pack in order to get any contained object, no matter how many
other objects in that pack they already have locally.</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-A
</term>
<listitem>
<simpara>
        Same as <literal>-a</literal>, unless <emphasis>-d</emphasis> is used.  Then any unreachable
        objects in a previous pack become loose, unpacked objects,
        instead of being left in the old pack.  Unreachable objects
        are never intentionally added to a pack, even when repacking.
        This option prevents unreachable objects from being immediately
        deleted by way of being left in the old pack and then
        removed.  Instead, the loose unreachable objects
        will be pruned according to normal expiry rules
        with the next <emphasis>git gc</emphasis> invocation. See <citerefentry>
<refentrytitle>git-gc</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-d
</term>
<listitem>
<simpara>
        After packing, if the newly created packs make some
        existing packs redundant, remove the redundant packs.
        Also run  <emphasis>git prune-packed</emphasis> to remove redundant
        loose object files.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-l
</term>
<listitem>
<simpara>
        Pass the <literal>--local</literal> option to <emphasis>git pack-objects</emphasis>. See
        <citerefentry>
<refentrytitle>git-pack-objects</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-f
</term>
<listitem>
<simpara>
        Pass the <literal>--no-reuse-delta</literal> option to <literal>git-pack-objects</literal>, see
        <citerefentry>
<refentrytitle>git-pack-objects</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-F
</term>
<listitem>
<simpara>
        Pass the <literal>--no-reuse-object</literal> option to <literal>git-pack-objects</literal>, see
        <citerefentry>
<refentrytitle>git-pack-objects</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-q
</term>
<listitem>
<simpara>
        Pass the <literal>-q</literal> option to <emphasis>git pack-objects</emphasis>. See
        <citerefentry>
<refentrytitle>git-pack-objects</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-n
</term>
<listitem>
<simpara>
        Do not update the server information with
        <emphasis>git update-server-info</emphasis>.  This option skips
        updating local catalog files needed to publish
        this repository (or a direct copy of it)
        over HTTP or FTP.  See <citerefentry>
<refentrytitle>git-update-server-info</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
--window=&lt;n&gt;
</term>
<term>
--depth=&lt;n&gt;
</term>
<listitem>
<simpara>
        These two options affect how the objects contained in the pack are
        stored using delta compression. The objects are first internally
        sorted by type, size and optionally names and compared against the
        other objects within <literal>--window</literal> to see if using delta compression saves
        space. <literal>--depth</literal> limits the maximum delta depth; making it too deep
        affects the performance on the unpacker side, because delta data needs
        to be applied that many times to get to the necessary object.
        The default value for --window is 10 and --depth is 50.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
--window-memory=&lt;n&gt;
</term>
<listitem>
<simpara>
        This option provides an additional limit on top of <literal>--window</literal>;
        the window size will dynamically scale down so as to not take
        up more than <emphasis>&lt;n&gt;</emphasis> bytes in memory.  This is useful in
        repositories with a mix of large and small objects to not run
        out of memory with a large window, but still be able to take
        advantage of the large window for the smaller objects.  The
        size can be suffixed with "k", "m", or "g".
        <literal>--window-memory=0</literal> makes memory usage unlimited, which is the
        default.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
--max-pack-size=&lt;n&gt;
</term>
<listitem>
<simpara>
        Maximum size of each output pack file. The size can be suffixed with
        "k", "m", or "g". The minimum size allowed is limited to 1 MiB.
        If specified,  multiple packfiles may be created.
        The default is unlimited, unless the config variable
        <literal>pack.packSizeLimit</literal> is set.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
-b
</term>
<term>
--write-bitmap-index
</term>
<listitem>
<simpara>
        Write a reachability bitmap index as part of the repack. This
        only makes sense when used with <literal>-a</literal> or <literal>-A</literal>, as the bitmaps
        must be able to refer to all reachable objects. This option
        overrides the setting of <literal>pack.writeBitmaps</literal>.
</simpara>
</listitem>
</varlistentry>
<varlistentry>
<term>
--pack-kept-objects
</term>
<listitem>
<simpara>
        Include objects in <literal>.keep</literal> files when repacking.  Note that we
        still do not delete <literal>.keep</literal> packs after <literal>pack-objects</literal> finishes.
        This means that we may duplicate objects, but this makes the
        option safe to use when there are concurrent pushes or fetches.
        This option is generally only useful if you are writing bitmaps
        with <literal>-b</literal> or <literal>pack.writeBitmaps</literal>, as it ensures that the
        bitmapped packfile has the necessary objects.
</simpara>
</listitem>
</varlistentry>
</variablelist>
</refsect1>
<refsect1 id="_configuration">
<title>Configuration</title>
<simpara>By default, the command passes <literal>--delta-base-offset</literal> option to
<emphasis>git pack-objects</emphasis>; this typically results in slightly smaller packs,
but the generated packs are incompatible with versions of Git older than
version 1.4.4. If you need to share your repository with such ancient Git
versions, either directly or via the dumb http or rsync protocol, then you
need to set the configuration variable <literal>repack.UseDeltaBaseOffset</literal> to
"false" and repack. Access from old Git versions over the native protocol
is unaffected by this option as the conversion is performed on the fly
as needed in that case.</simpara>
</refsect1>
<refsect1 id="_see_also">
<title>SEE ALSO</title>
<simpara><citerefentry>
<refentrytitle>git-pack-objects</refentrytitle><manvolnum>1</manvolnum>
</citerefentry>
<citerefentry>
<refentrytitle>git-prune-packed</refentrytitle><manvolnum>1</manvolnum>
</citerefentry></simpara>
</refsect1>
<refsect1 id="_git">
<title>GIT</title>
<simpara>Part of the <citerefentry>
<refentrytitle>git</refentrytitle><manvolnum>1</manvolnum>
</citerefentry> suite</simpara>
</refsect1>
</refentry>
